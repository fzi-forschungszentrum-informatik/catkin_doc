#!/usr/bin/env python
"""catkin_doc helps creating documentations for catkin packages"""

from catkin_doc.pkghandler import PkgHandler

from catkin_doc.formatters.markdown_formatter import MarkdownFormatter

import catkin_doc.pkghandler
import os
import sys


def main():
    """
    This function will search for python and cpp nodes.
    than for each of this nodes it will search for existing docu
    if no docu is found it will ask for path to docu
    than parse each docu file and compare to previously generated nodes
    at last the merged nodes are written to given file format
    """

    package_path = sys.argv[1]

    pkg_handler = PkgHandler(package_path)

    formatter = MarkdownFormatter()
    markdown_string = pkg_handler.doc.to_string(1, formatter)

    new_filename = os.path.join(package_path, "README.md")
    with open(new_filename, "w") as f:
        f.write(markdown_string)


if __name__ == "__main__":
    main()
